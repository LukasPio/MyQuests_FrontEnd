"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.init=void 0;var _globalState=_interopRequireDefault(require("../../globalState.js"));var _classes=require("../classes.js");var _isNodeEnv=require("../isNodeEnv.js");var _utils=require("../utils.js");var _domUtils=require("./domUtils.js");var _getters=require("./getters.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var sweetHTML="\n <div aria-labelledby=\"".concat(_classes.swalClasses.title,"\" aria-describedby=\"").concat(_classes.swalClasses["html-container"],"\" class=\"").concat(_classes.swalClasses.popup,"\" tabindex=\"-1\">\n   <button type=\"button\" class=\"").concat(_classes.swalClasses.close,"\"></button>\n   <ul class=\"").concat(_classes.swalClasses["progress-steps"],"\"></ul>\n   <div class=\"").concat(_classes.swalClasses.icon,"\"></div>\n   <img class=\"").concat(_classes.swalClasses.image,"\" />\n   <h2 class=\"").concat(_classes.swalClasses.title,"\" id=\"").concat(_classes.swalClasses.title,"\"></h2>\n   <div class=\"").concat(_classes.swalClasses["html-container"],"\" id=\"").concat(_classes.swalClasses["html-container"],"\"></div>\n   <input class=\"").concat(_classes.swalClasses.input,"\" id=\"").concat(_classes.swalClasses.input,"\" />\n   <input type=\"file\" class=\"").concat(_classes.swalClasses.file,"\" />\n   <div class=\"").concat(_classes.swalClasses.range,"\">\n     <input type=\"range\" />\n     <output></output>\n   </div>\n   <select class=\"").concat(_classes.swalClasses.select,"\" id=\"").concat(_classes.swalClasses.select,"\"></select>\n   <div class=\"").concat(_classes.swalClasses.radio,"\"></div>\n   <label class=\"").concat(_classes.swalClasses.checkbox,"\">\n     <input type=\"checkbox\" id=\"").concat(_classes.swalClasses.checkbox,"\" />\n     <span class=\"").concat(_classes.swalClasses.label,"\"></span>\n   </label>\n   <textarea class=\"").concat(_classes.swalClasses.textarea,"\" id=\"").concat(_classes.swalClasses.textarea,"\"></textarea>\n   <div class=\"").concat(_classes.swalClasses["validation-message"],"\" id=\"").concat(_classes.swalClasses["validation-message"],"\"></div>\n   <div class=\"").concat(_classes.swalClasses.actions,"\">\n     <div class=\"").concat(_classes.swalClasses.loader,"\"></div>\n     <button type=\"button\" class=\"").concat(_classes.swalClasses.confirm,"\"></button>\n     <button type=\"button\" class=\"").concat(_classes.swalClasses.deny,"\"></button>\n     <button type=\"button\" class=\"").concat(_classes.swalClasses.cancel,"\"></button>\n   </div>\n   <div class=\"").concat(_classes.swalClasses.footer,"\"></div>\n   <div class=\"").concat(_classes.swalClasses["timer-progress-bar-container"],"\">\n     <div class=\"").concat(_classes.swalClasses["timer-progress-bar"],"\"></div>\n   </div>\n </div>\n").replace(/(^|\n)\s*/g,"");/**
 * @returns {boolean}
 */var resetOldContainer=function resetOldContainer(){var oldContainer=(0,_getters.getContainer)();if(!oldContainer){return false}oldContainer.remove();(0,_domUtils.removeClass)([document.documentElement,document.body],[_classes.swalClasses["no-backdrop"],_classes.swalClasses["toast-shown"],_classes.swalClasses["has-column"]]);return true};var resetValidationMessage=function resetValidationMessage(){_globalState["default"].currentInstance.resetValidationMessage()};var addInputChangeListeners=function addInputChangeListeners(){var popup=(0,_getters.getPopup)();var input=(0,_domUtils.getDirectChildByClass)(popup,_classes.swalClasses.input);var file=(0,_domUtils.getDirectChildByClass)(popup,_classes.swalClasses.file);/** @type {HTMLInputElement} */var range=popup.querySelector(".".concat(_classes.swalClasses.range," input"));/** @type {HTMLOutputElement} */var rangeOutput=popup.querySelector(".".concat(_classes.swalClasses.range," output"));var select=(0,_domUtils.getDirectChildByClass)(popup,_classes.swalClasses.select);/** @type {HTMLInputElement} */var checkbox=popup.querySelector(".".concat(_classes.swalClasses.checkbox," input"));var textarea=(0,_domUtils.getDirectChildByClass)(popup,_classes.swalClasses.textarea);input.oninput=resetValidationMessage;file.onchange=resetValidationMessage;select.onchange=resetValidationMessage;checkbox.onchange=resetValidationMessage;textarea.oninput=resetValidationMessage;range.oninput=function(){resetValidationMessage();rangeOutput.value=range.value};range.onchange=function(){resetValidationMessage();rangeOutput.value=range.value}};/**
 * @param {string | HTMLElement} target
 * @returns {HTMLElement}
 */var getTarget=function getTarget(target){return typeof target==="string"?document.querySelector(target):target};/**
 * @param {SweetAlertOptions} params
 */var setupAccessibility=function setupAccessibility(params){var popup=(0,_getters.getPopup)();popup.setAttribute("role",params.toast?"alert":"dialog");popup.setAttribute("aria-live",params.toast?"polite":"assertive");if(!params.toast){popup.setAttribute("aria-modal","true")}};/**
 * @param {HTMLElement} targetElement
 */var setupRTL=function setupRTL(targetElement){if(window.getComputedStyle(targetElement).direction==="rtl"){(0,_domUtils.addClass)((0,_getters.getContainer)(),_classes.swalClasses.rtl)}};/**
 * Add modal + backdrop + no-war message for Russians to DOM
 *
 * @param {SweetAlertOptions} params
 */var init=exports.init=function init(params){// Clean up the old popup container if it exists
var oldContainerExisted=resetOldContainer();if((0,_isNodeEnv.isNodeEnv)()){(0,_utils.error)("SweetAlert2 requires document to initialize");return}var container=document.createElement("div");container.className=_classes.swalClasses.container;if(oldContainerExisted){(0,_domUtils.addClass)(container,_classes.swalClasses["no-transition"])}(0,_domUtils.setInnerHtml)(container,sweetHTML);var targetElement=getTarget(params.target);targetElement.appendChild(container);setupAccessibility(params);setupRTL(targetElement);addInputChangeListeners()};