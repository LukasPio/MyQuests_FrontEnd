"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderInput=void 0;var _privateProps=_interopRequireDefault(require("../../../privateProps.js"));var _classes=require("../../classes.js");var dom=_interopRequireWildcard(require("../../dom/index.js"));var _utils=require("../../utils.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{"default":e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}/// <reference path="../../../../sweetalert2.d.ts"/>
/**
 * @typedef { HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement } Input
 * @typedef { 'input' | 'file' | 'range' | 'select' | 'radio' | 'checkbox' | 'textarea' } InputClass
 */ /** @type {InputClass[]} */var inputClasses=["input","file","range","select","radio","checkbox","textarea"];/**
 * @param {SweetAlert} instance
 * @param {SweetAlertOptions} params
 */var renderInput=exports.renderInput=function renderInput(instance,params){var popup=dom.getPopup();if(!popup){return}var innerParams=_privateProps["default"].innerParams.get(instance);var rerender=!innerParams||params.input!==innerParams.input;inputClasses.forEach(function(inputClass){var inputContainer=dom.getDirectChildByClass(popup,_classes.swalClasses[inputClass]);if(!inputContainer){return}// set attributes
setAttributes(inputClass,params.inputAttributes);// set class
inputContainer.className=_classes.swalClasses[inputClass];if(rerender){dom.hide(inputContainer)}});if(params.input){if(rerender){showInput(params)}// set custom class
setCustomClass(params)}};/**
 * @param {SweetAlertOptions} params
 */var showInput=function showInput(params){if(!params.input){return}if(!renderInputType[params.input]){(0,_utils.error)("Unexpected type of input! Expected ".concat(Object.keys(renderInputType).join(" | "),", got \"").concat(params.input,"\""));return}var inputContainer=getInputContainer(params.input);var input=renderInputType[params.input](inputContainer,params);dom.show(inputContainer);// input autofocus
if(params.inputAutoFocus){setTimeout(function(){dom.focusInput(input)})}};/**
 * @param {HTMLInputElement} input
 */var removeAttributes=function removeAttributes(input){for(var i=0;i<input.attributes.length;i++){var attrName=input.attributes[i].name;if(!["id","type","value","style"].includes(attrName)){input.removeAttribute(attrName)}}};/**
 * @param {InputClass} inputClass
 * @param {SweetAlertOptions['inputAttributes']} inputAttributes
 */var setAttributes=function setAttributes(inputClass,inputAttributes){var input=dom.getInput(dom.getPopup(),inputClass);if(!input){return}removeAttributes(input);for(var attr in inputAttributes){input.setAttribute(attr,inputAttributes[attr])}};/**
 * @param {SweetAlertOptions} params
 */var setCustomClass=function setCustomClass(params){var inputContainer=getInputContainer(params.input);if(_typeof(params.customClass)==="object"){dom.addClass(inputContainer,params.customClass.input)}};/**
 * @param {HTMLInputElement | HTMLTextAreaElement} input
 * @param {SweetAlertOptions} params
 */var setInputPlaceholder=function setInputPlaceholder(input,params){if(!input.placeholder||params.inputPlaceholder){input.placeholder=params.inputPlaceholder}};/**
 * @param {Input} input
 * @param {Input} prependTo
 * @param {SweetAlertOptions} params
 */var setInputLabel=function setInputLabel(input,prependTo,params){if(params.inputLabel){var label=document.createElement("label");var labelClass=_classes.swalClasses["input-label"];label.setAttribute("for",input.id);label.className=labelClass;if(_typeof(params.customClass)==="object"){dom.addClass(label,params.customClass.inputLabel)}label.innerText=params.inputLabel;prependTo.insertAdjacentElement("beforebegin",label)}};/**
 * @param {SweetAlertOptions['input']} inputType
 * @returns {HTMLElement}
 */var getInputContainer=function getInputContainer(inputType){return dom.getDirectChildByClass(dom.getPopup(),_classes.swalClasses[inputType]||_classes.swalClasses.input)};/**
 * @param {HTMLInputElement | HTMLOutputElement | HTMLTextAreaElement} input
 * @param {SweetAlertOptions['inputValue']} inputValue
 */var checkAndSetInputValue=function checkAndSetInputValue(input,inputValue){if(["string","number"].includes(_typeof(inputValue))){input.value="".concat(inputValue)}else if(!(0,_utils.isPromise)(inputValue)){(0,_utils.warn)("Unexpected type of inputValue! Expected \"string\", \"number\" or \"Promise\", got \"".concat(_typeof(inputValue),"\""))}};/** @type {Record<SweetAlertInput, (input: Input | HTMLElement, params: SweetAlertOptions) => Input>} */var renderInputType={};/**
 * @param {HTMLInputElement} input
 * @param {SweetAlertOptions} params
 * @returns {HTMLInputElement}
 */renderInputType.text=renderInputType.email=renderInputType.password=renderInputType.number=renderInputType.tel=renderInputType.url=renderInputType.search=renderInputType.date=renderInputType["datetime-local"]=renderInputType.time=renderInputType.week=renderInputType.month=function(input,params){checkAndSetInputValue(input,params.inputValue);setInputLabel(input,input,params);setInputPlaceholder(input,params);input.type=params.input;return input};/**
 * @param {HTMLInputElement} input
 * @param {SweetAlertOptions} params
 * @returns {HTMLInputElement}
 */renderInputType.file=function(input,params){setInputLabel(input,input,params);setInputPlaceholder(input,params);return input};/**
 * @param {HTMLInputElement} range
 * @param {SweetAlertOptions} params
 * @returns {HTMLInputElement}
 */renderInputType.range=function(range,params){var rangeInput=range.querySelector("input");var rangeOutput=range.querySelector("output");checkAndSetInputValue(rangeInput,params.inputValue);rangeInput.type=params.input;checkAndSetInputValue(rangeOutput,params.inputValue);setInputLabel(rangeInput,range,params);return range};/**
 * @param {HTMLSelectElement} select
 * @param {SweetAlertOptions} params
 * @returns {HTMLSelectElement}
 */renderInputType.select=function(select,params){select.textContent="";if(params.inputPlaceholder){var placeholder=document.createElement("option");dom.setInnerHtml(placeholder,params.inputPlaceholder);placeholder.value="";placeholder.disabled=true;placeholder.selected=true;select.appendChild(placeholder)}setInputLabel(select,select,params);return select};/**
 * @param {HTMLInputElement} radio
 * @returns {HTMLInputElement}
 */renderInputType.radio=function(radio){radio.textContent="";return radio};/**
 * @param {HTMLLabelElement} checkboxContainer
 * @param {SweetAlertOptions} params
 * @returns {HTMLInputElement}
 */renderInputType.checkbox=function(checkboxContainer,params){var checkbox=dom.getInput(dom.getPopup(),"checkbox");checkbox.value="1";checkbox.checked=Boolean(params.inputValue);var label=checkboxContainer.querySelector("span");dom.setInnerHtml(label,params.inputPlaceholder);return checkbox};/**
 * @param {HTMLTextAreaElement} textarea
 * @param {SweetAlertOptions} params
 * @returns {HTMLTextAreaElement}
 */renderInputType.textarea=function(textarea,params){checkAndSetInputValue(textarea,params.inputValue);setInputPlaceholder(textarea,params);setInputLabel(textarea,textarea,params);/**
   * @param {HTMLElement} el
   * @returns {number}
   */var getMargin=function getMargin(el){return parseInt(window.getComputedStyle(el).marginLeft)+parseInt(window.getComputedStyle(el).marginRight)};// https://github.com/sweetalert2/sweetalert2/issues/2291
setTimeout(function(){// https://github.com/sweetalert2/sweetalert2/issues/1699
if("MutationObserver"in window){var initialPopupWidth=parseInt(window.getComputedStyle(dom.getPopup()).width);var textareaResizeHandler=function textareaResizeHandler(){// check if texarea is still in document (i.e. popup wasn't closed in the meantime)
if(!document.body.contains(textarea)){return}var textareaWidth=textarea.offsetWidth+getMargin(textarea);if(textareaWidth>initialPopupWidth){dom.getPopup().style.width="".concat(textareaWidth,"px")}else{dom.applyNumericalStyle(dom.getPopup(),"width",params.width)}};new MutationObserver(textareaResizeHandler).observe(textarea,{attributes:true,attributeFilter:["style"]})}});return textarea};